# MyExploit-ShellShock
In this small repository you will find my first exploit, which takes advantage of the well-known ShellShock vulnerability on a vulnerable site. Here you will find the necessary tools to use my exploit and a proof of concept (PoC).

## ShellShock
ShellShock is a security vulnerability that affects Bash shell software used in Unix and Linux operating systems. This vulnerability allows attackers to execute malicious code on a system by manipulating environment variables.

In the context of a website, the ShellShock vulnerability could be exploited if the web server is configured to use CGI (Common Gateway Interface) scripts that use Bash to process web requests. If an attacker can send a malicious request to one of these CGI scripts and manipulate environment variables, they could execute malicious code on the server and take control of the website.

Therefore, if a website uses CGI scripts that use Bash, it is important to ensure that the corresponding patch has been applied to fix the ShellShock vulnerability and that security recommendations are being followed to prevent the vulnerability from being exploited. In addition, it is recommended to regularly review and update the configuration and software of the web server to ensure that the latest and most secure versions are being used.

## PoC
Let's start by cloning the repository:

    git clone https://github.com/andrewxx007/MyExploit-ShellShock.git
    
To initiate the vulnerable environment, simply execute:

    docker run --rm -it -p 8080:80 vulnerables/cve-2014-6271
    
Access your browser and navigate to localhost:8080. If everything is working correctly, a page similar to this one will be displayed.

![VulnerableSite](/vulnerable_site.png)

## Usage
Grant the necessary permissions to the exploit script.

    chmod +x myexploit-shellshock.sh

This is a sample code snippet in exploit-deface.sh that can be executed on an image. 

    ./myexploit-shellshock.sh <ip> <port>

For instance, if you run it using the command provided above.

    ./myexploit-shellshock.sh localhost 8080

Refresh your browser and your website has just become a victim of my ShellShock exploit!

![RunExploit](/run_exploit.png)

## What happened?
This is a shell script that exploits a vulnerability in a CGI (Common Gateway Interface) program running on a remote web server that is affected by the vulnerability known as "Shellshock".

The script checks whether the user has provided the necessary IP and port arguments for exploitation. If the user hasn't provided the required arguments, a message will be displayed indicating how to use the script correctly.

Then, the script uses the "curl" command to send the exploit to the remote web server via the CGI vulnerability. The exploit uses a malicious "user-agent" that exploits the "Shellshock" vulnerability to execute a malicious command on the server. In this case, the malicious command is to create an HTML file in the "/var/www/" directory with a defacement message.

Once the exploit is successfully sent to the server, the script uses the "curl" command to verify if the defacement page has been implemented correctly on the remote web server. Finally, the script displays a message indicating that the exploit has completed successfully.

## Reference 
These are the CVEs my exploit was based on and an explanation of them.

### CVE-2014-6271
The CVE-2014-6271, also known as Shellshock, is a security vulnerability that affects the Bash shell utility in Unix and Linux-based operating systems. It was discovered in September 2014 and is considered one of the most critical security flaws of the decade.

The vulnerability allows attackers to execute malicious code on a vulnerable system using Bash's variable exporting function. Attackers can exploit this vulnerability to gain unauthorized access to systems, steal confidential information, or compromise the security of a network.

Shellshock affected a large number of systems, including web servers, IoT devices, and other internet-connected devices. Many organizations had to patch their systems and update their software applications to protect themselves against this vulnerability.

Although a patch has been created for Shellshock, it is important to keep systems up to date and stay aware of the latest security threats to protect against future vulnerabilities. Additionally, it is important to follow security best practices, such as implementing strong passwords and using multifactor authentication, to minimize security risks in systems.

### CVE-2014-7169
Also known as "Shellshock 2", is a security vulnerability that was discovered in September 2014 in the same software as the CVE-2014-6271 (Shellshock) vulnerability. This vulnerability allowed attackers to evade the patch that had been developed for Shellshock and continue executing malicious code on affected systems.

The CVE-2014-7169 vulnerability primarily affected systems that used Bash's redirection function and allowed attackers to execute malicious commands through the use of manipulated environment variables. This meant that attackers could exploit the vulnerability to gain unauthorized access to systems, steal confidential information, and compromise network security.

The vulnerability was considered severe, and many organizations had to update their systems and software applications to protect themselves against this threat. Although a patch was created for CVE-2014-7169, it is important to note that security vulnerabilities can be discovered at any time, so it is necessary to keep systems updated and follow best security practices.

In summary, CVE-2014-7169 is a security vulnerability that allowed attackers to execute malicious code on affected systems through the use of manipulated environment variables. The vulnerability was considered severe, and organizations are recommended to keep their systems updated and follow best security practices to minimize security risks in their systems.

